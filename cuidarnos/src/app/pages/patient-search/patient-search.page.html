<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/doctor/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Patient Search</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="search-container">
    <!-- Search Bar -->
    <ion-card class="search-card">
      <div class="search-header">
        <ion-searchbar 
          [(ngModel)]="searchTerm"
          (ionInput)="onSearchInput($event)"
          placeholder="Search by name, ID, or phone number"
          show-clear-button="focus">
        </ion-searchbar>
      </div>
      
      <div class="search-filters" *ngIf="searchTerm">
        <ion-chip 
          *ngFor="let filter of searchFilters" 
          [color]="filter.active ? 'primary' : 'medium'"
          (click)="toggleFilter(filter)">
          <ion-icon [name]="filter.icon"></ion-icon>
          <ion-label>{{filter.name}}</ion-label>
        </ion-chip>
      </div>
    </ion-card>

    <!-- Search Results -->
    <div class="results-container" *ngIf="searchTerm && filteredPatients.length > 0">
      <div class="results-header">
        <h3>Search Results ({{filteredPatients.length}})</h3>
      </div>
      
      <div class="patients-list">
        <ion-card *ngFor="let patient of filteredPatients" class="patient-card">
          <div class="patient-content">
            <div class="patient-avatar">
              <ion-icon name="person"></ion-icon>
            </div>
            
            <div class="patient-info">
              <h3 class="patient-name">{{patient.firstName}} {{patient.lastName}}</h3>
              <p class="patient-details">ID: {{patient.id}} • Age: {{patient.age}}</p>
              <p class="patient-contact">{{patient.phone}} • {{patient.email}}</p>
              <div class="patient-conditions" *ngIf="patient.conditions.length > 0">
                <ion-badge 
                  *ngFor="let condition of patient.conditions.slice(0, 2)" 
                  color="danger" 
                  class="condition-badge">
                  {{condition}}
                </ion-badge>
                <span *ngIf="patient.conditions.length > 2" class="more-conditions">
                  +{{patient.conditions.length - 2}} more
                </span>
              </div>
            </div>
            
            <div class="patient-actions">
              <ion-button 
                class="edit-button"
                (click)="editPatientFile(patient)">
                <ion-icon slot="start" name="create"></ion-icon>
                Edit File
              </ion-button>
              
              <ion-button 
                fill="outline" 
                class="view-button"
                (click)="viewPatientFile(patient)">
                <ion-icon slot="start" name="eye"></ion-icon>
                View
              </ion-button>
            </div>
          </div>
          
          <div class="patient-status">
            <ion-badge [color]="patient.status === 'Active' ? 'success' : 'medium'">
              {{patient.status}}
            </ion-badge>
            <span class="last-visit">Last visit: {{patient.lastVisit}}</span>
          </div>
        </ion-card>
      </div>
    </div>

    <!-- No Results -->
    <div *ngIf="searchTerm && filteredPatients.length === 0" class="no-results">
      <ion-card>
        <div class="no-results-content">
          <ion-icon name="search-outline"></ion-icon>
          <h3>No patients found</h3>
          <p>Try adjusting your search terms or filters.</p>
        </div>
      </ion-card>
    </div>

    <!-- Initial State -->
    <div *ngIf="!searchTerm" class="initial-state">
      <ion-card>
        <div class="initial-content">
          <ion-icon name="people-outline"></ion-icon>
          <h3>Search for Patients</h3>
          <p>Enter a patient's name, ID, or phone number to find their medical records.</p>
        </div>
      </ion-card>
    </div>
  </div>
</ion-content>